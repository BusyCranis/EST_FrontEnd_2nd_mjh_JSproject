<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div>
      <div style="display: flex">
        <div>구매회원가입</div>
        <div>판매회원가입</div>
      </div>
      아이디
      <input
        id="checkAccountDup"
        type="text"
        onchange="changeCheckedDupByNewInput()"
      />
      <button onclick="accountNameDup()">중복확인</button>
      <br />
      비밀번호
      <input id="pwinput" type="text" /><br />
      비밀번호 재확인
      <input id="checkpwinput" type="text" /><br />
      이름
      <input id="username" type="text" /><br />
      휴대폰 번호
      <select id="phoneFirst">
        <option value="010">010</option>
      </select>
      <input id="midphone" type="text" />
      <input id="lastphone" type="text" />
      <br />
      <input id="agreeUseTerm" type="checkbox" />
      호두샵의 이용약관 및 개인정보처리방침에 대한 내용을 확인하였고 동의합니다.
      <br />
      <button onclick="requestSignup()">가입하기</button>
    </div>

    <script>
      let checkAccountDup = document.getElementById("checkAccountDup");
      let phoneFirst = document.getElementById("phoneFirst");
      var hasCheckedDuplicate = false;

      function accountNameDup() {
        console.log(checkAccountDup.value);
        fetch(
          "https://estapi.openmarket.weniv.co.kr/accounts/validate-username/",
          {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              username: checkAccountDup.value,
            }),
          }
        )
          .then((response) => response.json())
          .then((json) => {
            console.log(json);
            if (json.message) {
              hasCheckedDuplicate = true;
            } else if (json.error) {
              hasCheckedDuplicate = false;
            }
          })
          .catch((error) => console.error(error));
      }

      function changeCheckedDupByNewInput() {
        console.log(hasCheckedDuplicate);
        if (hasCheckedDuplicate === true) {
          hasCheckedDuplicate = false;
        }
      }

      function requestSignup() {
        console.log(phoneFirst);
        console.log(phoneFirst.value);
        console.log(typeof phoneFirst.value);
      }
    </script>
  </body>
</html>
